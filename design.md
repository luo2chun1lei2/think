# 设计

***
## 基本规则
1. 语言中所有的对象都可以称为“元素”（Element）。
1. 关系也是一种元素，它是多个元素之间的联系。
    1. 可以根据元素的关系找到其他的元素，也可以根据元素找到和它有联系的关系。
    1. 关系一旦建立，就需要维护。
        1. 如果一个元素变动，所有关联的元素都变化，会引起性能问题，所以可以延迟修改，直到使用这个元素为止。
    1. 约束关系，用来验证多个元素之间是否此关系成立。比如 a>b，或者c=max(v0, v1, ...)。
        1. 也可以建立约束关系后，元素值发生改变后，都必须遵守，否则触发事件或者改动作废。
    2. 变换关系，关系的某个元素可以根据其他的元素得到。比如c=a+b，当a和b的值改变后，可以通过关系得到c的值。
        1. 关系不一定可以逆运算，即使这个公式真的可以逆运算。比如：班级平均成绩修改后，是无法修改学生成绩的，即使学生只有一个。而且这个平均成绩应该是不可修改的。
1. 关系需要组合。**TODO**
1. 建立基本的元素，比如“值元素”，可以保存值。
 
***
## 脚本语言
最终，需要建立一套统一、一致、方便的脚本语言，相面就是语言的设想。
```
elm1.name = zhang
elm2.name = li
rel = teach(teacher=zhang, student=li) // “张”教“李”
elm1.student = rel  // 设定关系和名字
elm2.teacher = rel  // 设定关系和名字
? elm1.student // 查询是 li.
? elm2.teacher   // 查询是 zhang.
```

### 每个关系对于元素都有唯一的名字
同一个类型的关系，可能出现在一个对象中，如果都用关系的名称来定位，
那么肯定会重复。比如 校长管理老师，老师管理学生，这样老师就有两个管理关系，
所以必须允许每个元素设定自己的关系一个唯一的名字。

### 对于多元关系没有所谓正反关系
不过这里的语义应该是“被教学”，其实只有两元关系才有正关系和反关系，
对于三元以上的关系，其实没有什么所谓正反关系。

### 怎么定位关系-元素
关系中必须有每个相关的元素的名字，然后通过名字来定位。

### 怎么定位元素-关系-元素
如果是三个对象之间的关系，如何用类似属性的方式定位关联关系？
直角三角形勾股定理 c^2 = a^2 + b^2
c.勾股定理.a
c.勾股定理.b

先找到关系，然后定位关系中的那个元素，反过来推到两元关系
zhang.教学.学生 == li
li.教学.老师 == zhang

***
## 具体如何实现

* 如何区分不同的元素，包括关系，这里不准备类型，所以没有类型的名字，那么每个元素都用名字来显示？
    * 必须有名字（name)这个field？
    * 还是都用name这个relation？
